
-------------------------------------------------服务器部署 笔记--------------------------------------------------------
服务器电脑：不需要关闭防火墙
服务器笔记：服务器必须监听云服内网IP地址，外网用公网ip访问内网。
    一，SecureCRT或xshell安装
        1，前端安装SecureCRT 链接云服务器，拷贝发布后的文件到云服务器上

    二，云环境搭建和部署
        1，安装运行环境：       sudo yum install dotnet-sdk-6.0 8.5系统自带包
           手动安装dotnet:
           获取下载链接：https://dotnet.microsoft.com/en-us/download/dotnet/6.0
                <1>必须安装：yum install libicu
                <2>下载：wget  https://download.visualstudio.microsoft.com/download/pr/904da7d0-ff02-49db-bd6b-5ea615cbdfc5/966690e36643662dcc65e3ca2423041e/dotnet-sdk-5.0.408-linux-x64.tar.gz
                <3> mkdir -p $HOME/dotnet && tar zxf dotnet-sdk-5.0.408-linux-x64.tar.gz -C $HOME/dotnet
                <4> 配置到系统变量 /etc/profile  配置到文件最后
                    export DONET_ROOT=$PATH:/root/dotnet 目录路径
                    export PATH=$PATH:/root/dotnet 目录路径


                    用 yum 安装：
                    《1》 更新资料库：sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm
                    《2》 安装所有依赖：libunwind,lttng-ust,libcurl,openssl-libs,libuuid,krb5-libs,libicu,zlib
                    《3》 更新：yum update
                    《4》 安装sdk：sudo yum install dotnet-sdk-5.0
       
        2，启动运行权限命令：   chmod 777 程序文件名 
        3，运行程序命令：       ./程序名 或者 donet 程序名.dll
        4，安装运行环境dotnet-sdk-6.0(CentOS错误部分)
            Error: There are no enabled repositories in "/etc/yum.repos.d", "/etc/yum/repos.d", "/etc/distro.repos.d".
            出现以上错误，解决如下
            <1>, 安装yum 源，切换目录：  cd /etc/yum.repos.d
            <2>, 查看所有文件：         ll
            <3>, 删除当前的所有文件：    rm -rf ./*
            <4>, 下载镜像： wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-vault-8.5.2111.repo
            <5>, 查看donet信息命令： dotnet --info

    三，服务器发布
        1，前端安装SecureCRT 链接云服务器，拷贝发布后的文件到云服务器上
        2，点击项目鼠标右键-->选择发布-->(弹框)文件夹配置-->依赖框架模式，linux-x64，不勾选生成单个文件--->发布即可
        3，将发布的文件上传到云服务器。
        4，启动运行权限命令：chmod 777 程序文件名 
        5，持续运行程序命令： 
            《1》，安装： yum install screen
            《2》，创建screen窗口：screen -S 自定义名字
            《3》，输入Ctrl+a,再按下d,退出会一直运行
            《4》，进入进程：
                 一，一个时命令：screen -r -d
                 二，多个进程时：screen -r -d 进程pid               例如：screen -r -d 144567
                 三，关闭进程：  screen -S id.名字 -X quit          id.名字=查看进程时获取的
                 四，查看进程列表：screen -ls
    四，云服防火墙命令
        1，查看服务状态：systemctl status firewalld
        2，查看状态：firewall-cmd --state
        3，开启： service firewalld start
        4，重启：service firewalld restart
        5，关闭：service firewalld stop

    五，检查ip登录：telnet 43.139.57.32 9001/8080/9201
        检查ip网络: ping 43.139.57.32 -t
        查看列表：netstat -lntp

    六，查找命令:  find -name "nginx.conf"

/usr/local/dotnet
-------------------------------------------------后台部署 笔记--------------------------------------------------------
后台笔记：必须监听公网ip和端口
    一, 安装 node.js 环境
        0, 切换当前路径：cd /usr/local/
        1，下载文件：wget 下载网址（https://cdn.npmmirror.com/binaries/node/v16.18.1/node-v16.18.1-linux-x64.tar.xz）
        2，解压文件： tar -xvf 压缩文件路径（node-v16.18.1-linux-x64.tar.xz） -C
        3，重命名目录： mv 源目录名(node-v16.18.1-linux-x64) 新目录名(nodejs)
        4, 获取当前路径：pwd
        5, 配置环境变量： vi /etc/profile
            export NODE_HOME=/usr/local/nodejs(目录路径-配置文件最前面)
            export PATH=$NODE_HOME/bin:$PATH
        6, 环境变量生效： source /etc/profile
        7, 测试： node -v

    二，安装 nginx 环境
        0，帮助地址：https://blog.csdn.net/qq_41070393/article/details/108026079
        1, 安装nginx依赖
            命令： yum -y install gcc gcc-c++ automake pcre pcre-devel zlib zlib-devel openssl-devel
        2, 下载稳定版(Legscy versions)
            wget http://nginx.org/download/nginx-1.20.2.tar.gz
        3, 解压-编译-安装
            解压:tar -zxvf nginx-1.20.2.tar.gz
            进入目录： cd  nginx-1.20.2
            编译： ./configure --with-http_ssl_module --with-stream
            安装： make && make install
            查看编译参数： ./configure --help | more
        4, 开发访问端口
            /sbin/iptables -I INPUT -p tcp --dport 8080 -j ACCEPT
        5, nginx服务启动-停止
            自定义切换目录： cd /usr/local/nginx/sbin
                默认的安装路径：/etc/nginx/nginx.conf
            默认启动： ./nginx
            指定配置文件启动： ./nginx -c /usr/local/nginx/conf/nginx.conf
            停止服：cd /usr/local/nginx/sbin
             ./nginx -s stop
        6, 开机启动 nginx
            打开配置文件 ： vi /etc/rc.d/rc.local
            在后面添加（是可执行程序路径，不是目录路径）：/usr/local/nginx/sbin/nginx
            开启执行权限： chmod +x /etc/rc.d/rc.local
        
        7, 配置系统变量
            打开系统配置： vi /etc/profile
            添加一下配置，并执行生效指令： source /etc/profile  
               export PATH=$PATH:/uscdr/local/nginx/sbin
            然后执行: source /etc/profile 指令
            新建配置：mkdir -p /etc/nginx/conf.d
        8，查看指令
            查看版本： nginx -V
            检查配置:  nginx -t

    三 配置nginx web 参数
        1，配置nginx路径
            <1>, 打开配置文件： vi /usr/local/nginx/conf/nginx.conf
            <2>, 打开第一行： user root;
            <3>, 在server下配置端口，公网ip
                listen          8080;
                server_name     175.178.197.81;
            <4>, 在 location 下配置路径：
                root        /root/Backstage;
                index       index.html index.htm;
        2, 重启web服务(配置后) ： nginx -s reload
        3, 查看用户监听： ps aux | grep nginx      **(如果都是root ,那么配置ok，否则检查一下)
        4, 查看用户进程：ps -ef | grep nginx
        5，启动目录权限： chmod -R 777 目录路径(热更目录和后台目录)
        6，查看所有ip: netstat -ntlp
        7，只提交dist目录到云服务器配置root下的目录： static, index.html, favicon.ico
        8，访问地址：http://43.139.57.32：8080

    四，发布后台前端 vue
        1, 开发环境命令： npm run dev
        2, 发布环境命令： npm rum build:prod
            上传文件：将dist 目录下的文件上传到云目录下即可
        3, vue项目里：全部配置公网ip，查看config/ipconfig.js
            ipconfig引用脚本：src/utils/request.js
        4，在main.js中注释掉模拟数据代码。

    五，支持热更新路径配置如下(同时支持网站)
        user root;#配置到文件的第一行，阿里云服务器必须强度根目录
        http {
            #... ...
            #默认省略部分
            #... ...
            server {
                listen       8080;
                server_name  43.139.57.32;
                charset utf-8;
                
                #后台网站配置，location主要做目录区分配置
                location / {
                    root   /root/backstage;#后台目录
                    index  index.html index.htm;
                }

                location /web {
                    alias /root/web;#网络磁盘的目录路径
                    if ($request_filename ~* ^.*?\.(txt|ab|jpg|png|json)$){
                          add_header Content-Disposition 'attachment;';
                    }
                     autoindex on;  #开启目录文件列表
                     autoindex_exact_size on;#显示出文件的确切大学，单位bytes
                     autoindex_format html; #设置目录列表的格式为 html
                     autoindex_localtime on;  #显示的文件时间为文件服务器时间

                     charset utf-8,gbk;     #避免中文乱码
                }
                #... ...
            }
        }


    六，上传和下载

            location /download {

                root /yinzhengjie/data/web/nginx;

                autoindex on;

                autoindex_exact_size on;

                autoindex_localtime on;

                limit_rate 10k;

            }

            location /upload {

                root /yinzhengjie/data/web/nginx;
        　　　　　#排除GET方法外，其它方法均可以在当前localtion使用，而且我们只允许172.30.1.108节点来访问。

                limit_except GET {

                   allow 172.30.1.108;

                   deny all;

                }

            }



-------------------------------SVN 服务器重启-----------------------------------------
一，svn服务器：需要关闭防火墙才可以远程链接
    https://cloud.tencent.com/developer/article/2034908
    1，安装和部署
        安装：yum install subversion
        创建目录：mkdir /usr/local/svn
        拷贝目录和文件：  cp -r 源目录和文件 新的目录和文件路径
        切换目录：cd /usr/local/svn
        创建仓库：svnadmin create game
        切换到目录：cd game/conf
        添加用户：vi passwd
            luckyGame = 123456
            mac = 123456
        添加权限： vi authz
            admin = xpy,test1 ---自定义组
            user = test2  ---用户组
            [/svn/test/] ---仓库路径
            @admin = rw  ---可读可写
            @user = r   ---只读
    2，重启命令:svnserve -d -r /svn/
    3，配置路径在：/usr/local/svn/game/conf
    4，停止svn 服务：  killall svnserve
    5, 查看和设置
        查看端口：netstat -tunlp | grep svn
        设置端口：svnserve -d --listen-port 3690 -r /svn/

    访问地址：svn://43.139.57.32:3690/game

    以下是在Linux中部署SVN服务器的一些基本命令：
        安装Subversion：sudo apt-get install subversion
        创建SVN仓库：sudo svnadmin create /path/to/repository
        配置SVN访问权限：使用htpasswd创建用户和密码，然后编辑svnserve.conf文件并添加以下行：
        auth-access = write
        password-db = /path/to/password/file
        realm = My First Repository
        启动SVN服务：svnserve -d -r /path/to/repository
        导入项目到SVN仓库：svn import /path/to/project file:///path/to/repository -m "Initial import"
        检出SVN仓库：svn checkout svn://hostname/path/to/repository
        添加新文件到SVN仓库：svn add filename
        提交修改到SVN仓库：svn commit -m "Commit message"



在Linux中设置C#服务器开机启动，可以使用systemd服务管理器。
    创建一个名为your_service_name.service的服务文件，并将其保存到/etc/systemd/system目录中。
    在your_service_name.service文件中，指定你要运行的C#服务器程序的路径和任何必要的参数或选项。
    使用systemctl命令来启用该服务：sudo systemctl enable your_service_name
    使用systemctl命令来启动该服务：sudo systemctl start your_service_name
    验证服务是否正在运行：sudo systemctl status your_service_name


    以下是 your_service_name.service 文件结构
    [Unit]
    Description=My C# Service

    [Service]
    Type=simple
    ExecStart=/usr/bin/dotnet /path/to/my/service.dll //启动命令
    Restart=always

    [Install]
    WantedBy=multi-user.target


https://download.visualstudio.microsoft.com/download/pr/73a9cb2a-1acd-4d20-b864-d12797ca3d40/075dbe1dc3bba4aa85ca420167b861b6/dotnet-sdk-5.0.201-linux-x64.tar.gz
